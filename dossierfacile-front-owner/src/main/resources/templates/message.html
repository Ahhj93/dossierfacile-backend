<!DOCTYPE html>
<html lang="en"
      layout:decorator="layout"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title>DossierFacile</title>
</head>
<body>
<div layout:fragment="content" th:remove="tag">

    <div class="main-container">

        <section class="bg--secondary space--sm conversation message-height">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4">
                        <div class="boxed boxed--lg boxed--border">
                            <ul class="menu-vertical">
                                <li>
                                    <a class="modal-file-button" data-id="1" href="#">Pièce d'identité</a>
                                    <a class="nounderline" id="link-file-1" target="_blank"
                                       th:href="${tenant.getUpload1Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(1)"></span>
                                </li>
                                <li>
                                    <a class="modal-file-button" data-id="2" href="#">Justificatif de domicile</a>
                                    <a class="nounderline" id="link-file-2" target="_blank"
                                       th:href="${tenant.getUpload2Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(2)"></span>
                                </li>
                                <li>
                                    <a class="modal-file-button" data-id="3" href="#">Contrat de travail</a>
                                    <a class="nounderline" id="link-file-3" target="_blank"
                                       th:href="${tenant.getUpload3Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(3)"></span>
                                </li>
                                <li>
                                    <a class="modal-file-button" data-id="4" href="#">Avis d'imposition</a>
                                    <a class="nounderline" id="link-file-4" target="_blank"
                                       th:href="${tenant.getUpload4Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(4)"></span>
                                </li>
                                <li>
                                    <a class="modal-file-button" data-id="5" href="#">Justificatif de ressources</a>
                                    <a class="nounderline" id="link-file-5" target="_blank"
                                       th:href="${tenant.getUpload5Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(5)"></span>
                                </li>
                            </ul>
                        </div>
                        <div class="boxed boxed--lg boxed--border"
                             th:if="${tenant.getGuarantor()!=null and tenant.getGuarantor().getGuarantorType().name()=='LOCATIO'}">
                            <h5>Les documents de mon garant</h5>
                            <ul class="menu-vertical">
                                <li>
                                    <a class="modal-file-button" data-id="6" href="#">Pièce di'identité</a>
                                    <a class="nounderline" id="link-file-6" target="_blank"
                                       th:href="${tenant.getGuarantor().getUpload1Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(6)"></span>
                                </li>
                                <li>
                                    <a class="modal-file-button" data-id="7" href="#">Justificatif de domicile</a>
                                    <a class="nounderline" id="link-file-7" target="_blank"
                                       th:href="${tenant.getGuarantor().getUpload2Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(7)"></span>
                                </li>
                                <li>
                                    <a class="modal-file-button" data-id="8" href="#">Contrat de travail</a>
                                    <a class="nounderline" id="link-file-8" target="_blank"
                                       th:href="${tenant.getGuarantor().getUpload3Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(8)"></span>
                                </li>
                                <li>
                                    <a class="modal-file-button" data-id="9" href="#">Avis d'imposition</a>
                                    <a class="nounderline" id="link-file-9" target="_blank"
                                       th:href="${tenant.getGuarantor().getUpload4Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(9)"></span>
                                </li>
                                <li>
                                    <a class="modal-file-button" data-id="10" href="#">Justificatif de ressources</a>
                                    <a class="nounderline" id="link-file-10" target="_blank"
                                       th:href="${tenant.getGuarantor().getUpload5Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(10)"></span>
                                </li>
                            </ul>
                        </div>
                        <div class="boxed boxed--lg boxed--border"
                             th:if="${tenant.getGuarantor()!=null and tenant.getGuarantor().getGuarantorType().name()=='VISALE'}">
                            <h5>Les documents de mon garant</h5>
                            <ul class="menu-vertical">
                                <li>
                                    <a class="modal-file-button" data-id="6" href="#">Visa</a>
                                    <a id="link-file-6" target="_blank"
                                       th:href="${tenant.getGuarantor().getUpload1Route()}">
                                        <span class="btn__text icon icon-Eye icon--xs"></span>
                                    </a>
                                    <span class="btn__text" th:remove="tag"
                                          th:replace="include/file-status-profile:: status-span(6)"></span>
                                </li>
                            </ul>
                        </div>
                        <div class="feature feature-2 boxed boxed--border">
                            <i class="icon icon-Yes text-success"></i>
                            <div class="feature__body">
                                <p>
                                    Votre pièce est validée ! Plus besoin d’y toucher
                                </p>
                            </div>
                        </div>
                        <div class="feature feature-2 boxed boxed--border">
                            <i class="icon icon-Hour text-warning"></i>
                            <div class="feature__body">
                                <p>
                                    Nous sommes en cours de traitement de cette pièce
                                </p>
                            </div>
                        </div>
                        <div class="feature feature-2 boxed boxed--border">
                            <i class="icon icon-Close text-danger"></i>
                            <div class="feature__body">
                                <p>
                                    Vous devez modifier votre pièce afin que nous validions votre dossier
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="conversation__head boxed boxed--lg bg-orange">
                            <h4 class="text-white">Conversation</h4>
                            <span class="text-white">Conversation</span>
                        </div>
                        <div class="conversation__reply boxed boxed--border"
                             th:if="${tenant.getTenantFileStatus().name() != 'VALIDATED'}">
                            <form id="messageForm" th:action="@{/message/new}" th:method="post" th:object="${message}">
                                <div class="row">
                                    <div class="col-12">
                                        <textarea autocomplete="off" autofocus="autofocus" id="message"
                                                  placeholder="Tapez votre message ici" required="required" rows="4"
                                                  th:field="*{message}"
                                                  type="text"></textarea>
                                    </div>
                                    <div class="col-md-4">
                                        <button class="btn" id="formChat" type="submit">Répondre</button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div class="comments conversation__comments">
                            <ul class="comments__list" id="messageArea">
                                <th:block th:each="messageIt: ${messages}">
                                    <li>
                                        <div class="comment" th:if="${messageIt.getFromUser()!=null}">
                                            <div class="comment__body w-100">
                                                <h5 class="type--fine-print" th:text="${name}"></h5>

                                                <div class="comment__meta">
                                                    <span th:text="${#temporals.format(messageIt.getCreationDateTime(), 'dd MMMM YYYY, hh:mm a')}"></span>
                                                </div>

                                                <p th:utext="${messageIt.message}"></p>
                                            </div>
                                        </div>

                                        <div class="comment" th:if="${messageIt.getFromUser()==null}">
                                            <div class="comment__avatar">
                                                <img alt="Image" src="/assets/images/marie.jpg"
                                                     th:unless="${messageIt.customMessage}"/>
                                            </div>
                                            <div class="comment__body"
                                                 th:classappend="${messageIt.customMessage}?'w-100':''">

                                                <h5 class="type--fine-print">DossierFacile</h5>

                                                <div class="comment__meta">
                                                    <span th:text="${#temporals.format(messageIt.getCreationDateTime(), 'dd MMMM YYYY, hh:mm a')}"></span>
                                                </div>

                                                <p th:utext="${messageIt.message}"></p>
                                            </div>
                                        </div>
                                        <!--end comment-->
                                    </li>
                                </th:block>
                            </ul>
                        </div>
                        <!--end comments-->
                    </div>
                </div>
                <!--end of row-->
            </div>
            <!--end of container-->
        </section>

    </div>
    <div class="hidden">
        <form enctype="multipart/form-data" id="form-file" method="post"
              th:action="@{/file}"
              th:object="${fileDTO}">
            <input accept="image/*, .pdf" class="hidden"
                   th:field="*{file}"
                   type="file"/>
            <input th:field="*{number}" type="hidden"/>
            <input th:field="*{fileActionUploadType}" type="hidden"/>
        </form>
    </div>
    <div class="notification success-notification pos-right pos-top col-sm-4 col-md-3" data-animation="from-top"
         data-autohide="2000">
        <div class="boxed boxed--border border--round box-shadow">
            <div class="text-block">
                <h5>Modifications enregistrées !</h5>
                <p>Vos modifications ont bien été prises en compte et sont désormais appliquées.</p>
            </div>
        </div>
        <div class="notification-close-cross notification-close"></div>
    </div>
    <div class="notification error-notification pos-right pos-top col-sm-4 col-md-3" data-animation="from-top"
         data-autohide="2000">
        <div class="boxed boxed--border border--round box-shadow">
            <div class="text-block">
                <h5>Modifications annulées !</h5>
                <p>Un problème est survenu et nous n'avons pas pu prendre en compte vos modifications. Merci de
                    réessayer.</p>
            </div>
        </div>
        <div class="notification-close-cross notification-close"></div>
    </div>
    <div class="modal-container modal-file">
        <div class="modal-content section-modal">
            <section class="unpad ">
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-md-8 col-12">
                            <div class="feature feature-1">
                                <div class="feature__body boxed boxed--lg boxed--border text-center">
                                    <div class="modal-close modal-close-cross"></div>
                                    <div class="text-block">
                                        <h3>Je modifie mon document</h3>
                                        <div class="text-center">
                                            <p>Vous pouvez ajouter un document
                                                ou modifier le document
                                                actuel</p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="btn btn--primary btn-block modal-close file-modal mb-2"
                                                 data-action="ADD" data-id="1">
                                                <span class="btn__text">Ajouter un document</span>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="btn btn--primary btn-block modal-close file-modal"
                                                 data-action="EDIT" data-id="1">
                                                <span class="btn__text">Remplacer le document</span>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    <div th:if="${modalSatisfactionSurvey}">
        <div class="modal-container" data-autoshow="1">
            <div class="modal-content">
                <section class="unpad ">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-md-8 col-12">
                                <div class="feature feature-1">
                                    <div class="feature__body boxed boxed--lg boxed--border text-center">
                                        <div class="modal-close modal-close-cross"></div>
                                        <div class="text-block">
                                            <h3>Merci d'avoir utilisé DossierFacile ! Votre satisfaction est notre
                                                priorité
                                                alors ne soyez pas timide et donnez nous votre avis</h3>
                                        </div>
                                        <div class="row justify-content-center">
                                            <div class="col-md-3">
                                                <form th:action="@{/locataire/survey}" th:method="post">
                                                    <input name="survey_answer" type="hidden" value="1"/>
                                                    <button class="btn bg-button-chat-green btn-block modal-close text-uppercase">
                                                        <span class="color-white btn__text ">Ca m'a plu !</span>
                                                    </button>
                                                </form>
                                            </div>
                                            <div class="col-md-3">
                                                <form th:action="@{/locataire/survey}" th:method="post">
                                                    <input name="survey_answer" type="hidden" value="-1"/>
                                                    <button class="btn bg-button-chat-red btn-block modal-close text-uppercase"
                                                            type="submit">
                                                        <span class="color-white btn__text ">Bof...</span>
                                                    </button>
                                                </form>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
    <div th:if="${modalFeedback}">
        <div class="modal-container" data-autoshow="1">
            <div class="modal-content">
                <section class="unpad ">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-md-8 col-12">
                                <div class="feature feature-1">
                                    <div class="feature__body boxed boxed--lg boxed--border text-center">
                                        <div class="modal-close modal-close-cross"></div>
                                        <div class="text-block">
                                            <h3>On peut faire mieux ! En 3 mots, qu'est ce qui ne vous a pas plu ?</h3>
                                        </div>
                                        <form th:action="@{/locataire/feedback}" th:method="post">
                                            <div class="row justify-content-center">
                                                <div class="col-md-12">
                                                      <textarea autofocus="autofocus" maxlength="500"
                                                                name="feedback"
                                                                placeholder="Ce qui aurait pu être mieux c'est..."
                                                                required="required"
                                                                rows="4"></textarea>
                                                </div>
                                                <div class="col-md-3">
                                                    <button class="btn btn--primary btn-block modal-close text-uppercase">
                                                        <span class="btn__text">envoyer</span>
                                                    </button>
                                                </div>
                                            </div>
                                        </form>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</div>
<div layout:fragment="javascripts" th:remove="tag">
    <script>
        setInterval(function () {
            updateMessagesTenant();
        }, 30000);
    </script>

    <script th:inline="javascript">
        /*<![CDATA[*/
        var name = /*[[${name}]]*/ 'default';
        /*]]>*/
    </script>

    <script src="/js/replace-update-file.js"></script>
</div>
</body>
</html>